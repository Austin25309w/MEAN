<html style="margin: 20px;" ng-app="myApp">

<head>
    <title>1955 API Redux</title>
	 <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.3.5/angular.min.js"></script>
	<script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.3.5/angular-route.min.js"></script>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
	<script type="text/javascript">

        var myApp = angular.module('myApp',[]);

        myApp.factory('peopleFactory', function($http){
            var factory = {}, people;

            factory.index = function(callback){
                $http.get('/people').success(function(output){
                    people = output;
                    callback(people);
                })
            }

            factory.create = function(person,callback){
                $http.post('/new/'+person.name).success(function(output){
                    people = output;
                    callback(people);
                })
            }

            factory.destroy = function(person,callback){
                $http.get('/remove/'+person.name).success(function(output){
                    people = output;
                    callback(people);
                })
            }

            return factory;
        });

        myApp.controller('peopleController', function(peopleFactory){
            var that = this;

            var getPeople = function(){
                peopleFactory.index(function(data){
                    that.people = data;
                })
            }
            getPeople();

            this.addPerson = function(){
                peopleFactory.create(this.newPerson,function(data){
                    that.people = data;
                });
                this.newPerson = {};
            };

            // this.addPerson = function(){
            //     peopleFactory.edit(this.newPerson,function(data){
            //         that.people = data;
            //     });
            //     this.newPerson = {};
            // };

            this.removePerson = function(person){
                peopleFactory.destroy(person,function(data){
                    that.people = data;
                });
            };
        });
        

    </script>
</head>


<body ng-controller="peopleController as PC">
    <h2>1955 Dashboard</h2><hr><br>
    <h3>Add people who were born in 1955!</h3>
    <input ng-model='PC.newPerson.name' type="text"></input>
    <input ng-click='PC.addPerson()' value="Submit" type="submit"></input><br><br>

    <table class="table table-striped">
        <thead>
            <tr>
                <th>Name</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody>
            <tr ng-repeat="person in PC.people">
                <td ng-bind="person.name"></td>
                <td><button ng-click='PC.editPerson(person)'>Edit</button>
                <button ng-click='PC.removePerson(person)'>Delete</button></td>
            </tr>
        </tbody>
    </table>    
</body>

</html>