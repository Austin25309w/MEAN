<html style="margin: 20px;">

<head>
    <title>1955 API Redux</title>
	 <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.3.5/angular.min.js"></script>
	<script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.3.5/angular-route.min.js"></script>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
	<script type="text/javascript">

        var myApp = angular.module('myApp',['ngRoute']);

        myApp.config(function($routeProvider){
            $routeProvider
                .when('/',{
                    templateUrl: 'partials/show.html',
                    controller: 'peopleController',
                    controllerAs: 'PC'
                })
                .when('/edit',{
                    templateUrl: 'partials/edit.html',
                    controller: 'editController',
                    controllerAs: 'EC'
                })
                .otherwise({
                    redirectTo: '/'
                })
        });

        myApp.factory('peopleFactory', function($http){
            var factory = {}, people, chosenPerson;

            factory.index = function(callback){
                $http.get('/people').success(function(output){
                    people = output;
                    callback(people);
                })
            }

            factory.create = function(person,callback){
                $http.post('/new/'+person.name).success(function(output){
                    people = output;
                    callback(people);
                })
            }

            factory.showOne = function(person){
                chosenPerson = person.name;
            }

            factory.getOne = function(){
                return chosenPerson;
            }

            factory.destroy = function(person,callback){
                $http.get('/remove/'+person.name).success(function(output){
                    people = output;
                    callback(people);
                })
            }

            return factory;
        });

        myApp.controller('peopleController', function(peopleFactory){
            var that = this;
            var getPeople = function(){
                peopleFactory.index(function(data){
                    that.people = data;
                })
            }
            getPeople();

            this.addPerson = function(){
                peopleFactory.create(this.newPerson,function(data){
                    that.people = data;
                });
                this.newPerson = {};
            };

            this.showPerson = function(person){
                peopleFactory.showOne(person);
            }

            this.removePerson = function(person){
                peopleFactory.destroy(person,function(data){
                    that.people = data;
                });
            };
        });
        
        myApp.controller('editController', function(peopleFactory){
            var that = this;
            this.showPerson = peopleFactory.getOne();
        
        })

    </script>
</head>


<body>
    <div ng-app='myApp'>
       <div ng-view=''></div>
    </div>
</body>

</html>