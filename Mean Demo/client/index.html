<html style="margin: 20px;">

<head>
    <title>Full Mean Demo</title>
	 <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.3.5/angular.min.js"></script>
	<script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.3.5/angular-route.min.js"></script>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
	<script type="text/javascript">

        var friends_app = angular.module('friends_app', ['ngRoute']);

        friends_app.config(function($routeProvider){
			$routeProvider
				.when('/',{
					templateUrl: 'partials/partial.html',
					controller: 'FriendsController',
                    controllerAs: 'FC'
				})
		});

        friends_app.factory('FriendFactory', function($http) {
            var factory = {};
            var friends = [];

            factory.index = function(callback) {
                $http.get('/friends').success(function(output) {
                    friends = output;
                    callback(friends);
                });
                return friends;
            }

            factory.create = function(new_friend) {
                $http.post('/friends',new_friend).success(function(output){
                    return true;
                })
            }

            return factory;
        });

        friends_app.controller('FriendsController', function(FriendFactory) {
            var that = this;

            var index = function(){
                FriendFactory.index(function(data){
                    that.friends = data;
                });
            }
            index();

            this.addFriend = function() {
                if(FriendFactory.create(this.new_friend))
                    index();
                this.new_friend = {};
            }

        });
    </script>
</head>


<body>
    <div ng-app='friends_app'>
		<div ng-view=''></div>
	</div>
</body>

</html>